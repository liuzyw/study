{
  "title": "Redis",
  "cells": [
    {
      "type": "text",
      "data": "<div><div data-note-content=\"\" class=\"show-content\"><blockquote><p>一准备工作<br>二 安装redis服务器<br>三redis服务器的启动、使用和退出<br>四 配置php使用redis服务<br>五 常见问题</p></blockquote>\n<h2>一 准备工作</h2>\n<p><a href=\"http://www.jianshu.com/p/bed54fb6ca78\" target=\"_blank\">安装homebrew</a><br>安装php、nginx（或apache）或集成环境</p>\n<h2>二 安装redis服务器</h2>\n<ol>\n<li>\n<p>通过homebrew安装</p>\n<pre class=\"hljs mipsasm\"><code class=\"mipsasm\"><span class=\"hljs-keyword\">brew </span><span class=\"hljs-keyword\">install </span>redis</code></pre>\n</li>\n<li>\n<p>直接下载安装<br>本人是用这种方法安装的，安装完后才发现可以用homebrew安装</p>\n</li>\n</ol>\n<pre class=\"hljs vim\"><code class=\"vim\">curl -O http://redis.googlecode.<span class=\"hljs-keyword\">com</span>/<span class=\"hljs-keyword\">files</span>/redis-<span class=\"hljs-number\">2.8</span>.<span class=\"hljs-number\">7</span>.tar.gz\nsudo tar -zxf redis-<span class=\"hljs-number\">2.8</span>.<span class=\"hljs-number\">7</span>.tar.gz\nmv redis-<span class=\"hljs-number\">2.8</span>.<span class=\"hljs-number\">7</span> /usr/local/redis\n<span class=\"hljs-keyword\">cd</span> redis\nsudo <span class=\"hljs-keyword\">make</span>\nsudo <span class=\"hljs-keyword\">make</span> test\nsudo <span class=\"hljs-keyword\">make</span> install\nmv redis.<span class=\"hljs-keyword\">conf</span> /etc/reds.<span class=\"hljs-keyword\">conf</span></code></pre>\n<p>安装成功</p>\n<h2>三 redis服务器的启动、使用和退出</h2>\n<p><strong><em> 1 启动redis服务</em></strong><br>执行以下命令</p>\n<pre class=\"hljs awk\"><code class=\"awk\"><span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/bin/</span>redis-server <span class=\"hljs-regexp\">/etc/</span>redis.conf</code></pre>\n<p>出现下面的界面说明redis服务器安装成功</p>\n<div class=\"image-package\">\n<img src=\"quiver-image-url/6B54C0727E34C9C1AC758C14DE09E981.png\" data-original-src=\"http://upload-images.jianshu.io/upload_images/1903856-cce43f2a2e8893d2.png?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"cursor: zoom-in;\" width=\"649\" height=\"474\"><br><div class=\"image-caption\">redis服务启动界面</div>\n</div>\n<p>进入<code>/usr/local/bin</code>目录可以看到以下文件</p>\n<blockquote><p>dump.rdb  用于将缓存以文件的形式存储在硬盘中，需要设置权限，见文末<br>redis-cli    用于启动redis客户端</p></blockquote>\n<p><strong><em>2 查看redis服务是否启动</em></strong></p>\n<pre class=\"hljs vim\"><code class=\"vim\"><span class=\"hljs-keyword\">ps</span> aux | <span class=\"hljs-keyword\">grep</span> redis</code></pre>\n<p><strong><em>3 使用redis服务</em></strong></p>\n<blockquote>\n<p>注：启动redis服务器后终端所在的窗口就不能输入别的命令了(如下图所示)，需要在终端打开新的窗口才能使用客户端功能</p>\n<div class=\"image-package\">\n<img src=\"quiver-image-url/ED0F696FBFEF5C80799D9AE7E0795FD5.png\" data-original-src=\"http://upload-images.jianshu.io/upload_images/1903856-5a450ea099740390.png?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"cursor: zoom-in;\" width=\"725\" height=\"37\"><br><div class=\"image-caption\"></div>\n</div>\n</blockquote>\n<p>通过redis-cli命令可以启动redis客户端</p>\n<pre class=\"hljs avrasm\"><code class=\"avrasm\">redis-<span class=\"hljs-keyword\">cli</span></code></pre>\n<p>常用命令</p>\n<blockquote><p>keys * 查看所有键值<br>set (key) (value) 设置键key的值为value<br>append (key) (value2) 在键key的值后面加上value2<br>get (key) 查看键key的值</p></blockquote>\n<p>redis客户端使用举例：<br></p><div class=\"image-package\">\n<img src=\"quiver-image-url/BE1F81C7C98A81209FE2DEE845AD857E.png\" data-original-src=\"http://upload-images.jianshu.io/upload_images/1903856-bcc9300a43d5432f.png?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"cursor: zoom-in;\" width=\"287\" height=\"224\"><br><div class=\"image-caption\">使用redis客户端</div>\n</div>\n<p>6.23补充：如何设置和查看缓存时间</p>\n<blockquote><p>set a 123;//设置缓存：a=&gt;123<br>EXPIRE a 3600;//设置缓存时间（秒）<br>TTL a；//查看缓存剩余时间</p></blockquote>\n<p>6.24补充：如何清空所有缓存</p>\n<blockquote><p>flushall  //执行该命令后会清空redis服务器的所有缓存，一般用于应急处理，不应该作为常用命令</p></blockquote>\n<p><strong><em>4 退出redis服务</em></strong><br>（1）客户端退出<br>执行</p>\n<pre class=\"hljs arduino\"><code class=\"arduino\">redis-cli <span class=\"hljs-built_in\">shutdown</span></code></pre>\n<p>（2）关闭pid<br>先运行</p>\n<pre class=\"hljs vim\"><code class=\"vim\"><span class=\"hljs-keyword\">ps</span> -<span class=\"hljs-keyword\">u</span> jim(替换成你的用户名) -<span class=\"hljs-keyword\">o</span> pid,rss,<span class=\"hljs-keyword\">command</span> | <span class=\"hljs-keyword\">grep</span> redis-server</code></pre>\n<p>查看所有redis服务的pid号</p>\n<div class=\"image-package\">\n<img src=\"quiver-image-url/77518A02D0D5DF9EB69E8811AC06F7A6.png\" data-original-src=\"http://upload-images.jianshu.io/upload_images/1903856-e9f87d42742ceda1.png?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"cursor: zoom-in;\" width=\"811\" height=\"81\"><br><div class=\"image-caption\"></div>\n</div>\n<p>16.6.24日补充：还可以通过mac自带的活动监视器查看pid<br>如下图所示<br>通过Spotlight或alfred搜索<code>activity monitor</code>打开活动监视器<br>在活动监视器中搜索<code>redis-server</code>，即可得到pid号<br></p><div class=\"image-package\">\n<img src=\"quiver-image-url/B067AB8F324900CFD903E46764655EDD.png\" data-original-src=\"http://upload-images.jianshu.io/upload_images/1903856-25fd0656fd8110ac.png?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"cursor: zoom-in;\" width=\"799\" height=\"101\"><br><div class=\"image-caption\"></div>\n</div>\n<p>补充：如果你的电脑安装了oh my zsh<br>那么只需要在终端输入</p>\n<pre class=\"hljs bash\"><code class=\"bash\"><span class=\"hljs-built_in\">kill</span> redis</code></pre>\n<p>按tab，会自动替换成对应的pid（喜大普奔啊，各位）</p>\n<p>再运行</p>\n<pre class=\"hljs lsl\"><code class=\"lsl\">kill <span class=\"hljs-number\">-9</span> <span class=\"hljs-number\">27355</span></code></pre>\n<p>关闭redis服务对应的pid号，即可关闭redis服务</p>\n<ol><li><h2>五 常见问题</h2>\n<p>（1）Redis: Failed opening .rdb for saving: Permission denied<br>redis服务器会生成<code>dump.rdb</code>文件存储缓存，如果文件权限不够则无法读写该文件</p>\n<pre class=\"hljs awk\"><code class=\"awk\">cd <span class=\"hljs-regexp\">/usr/</span>loal<span class=\"hljs-regexp\">/bin</span></code></pre>\n<p>在<code>/usr/local/bin/</code>（默认文件目录）下执行命令</p>\n<pre class=\"hljs css\"><code class=\"css\"><span class=\"hljs-selector-tag\">chmod</span> 777 <span class=\"hljs-selector-tag\">dump</span><span class=\"hljs-selector-class\">.rdb</span></code></pre>\n</li>\n</ol>\n\n        </div>\n        <!--  -->\n\n        <div class=\"show-foot\"></div></div><br><br><br>"
    }
  ]
}